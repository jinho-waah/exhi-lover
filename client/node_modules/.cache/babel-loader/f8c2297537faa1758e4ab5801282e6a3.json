{"ast":null,"code":"import _regeneratorRuntime from\"/Users/andrew/Desktop/exhi/exhi/exhi-lover/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/andrew/Desktop/exhi/exhi/exhi-lover/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/andrew/Desktop/exhi/exhi/exhi-lover/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import{fetchShowTagsId,fetchTagName}from\"../../lib/api/Api\";function FetchShowTags(galleriesInfo){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),tagIdsList=_useState2[0],setTagIdsList=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),tagsList=_useState4[0],setTagsList=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),tagIdsError=_useState6[0],setTagIdsError=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),tagsError=_useState8[0],setTagsError=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),showIds=_useState10[0],setShowIds=_useState10[1];//   console.log(\"ga\", galleriesInfo);\nuseEffect(function(){if(galleriesInfo!==null){setShowIds(galleriesInfo.map(function(galleryInfo){return galleryInfo.id;}));}},[galleriesInfo]);//   console.log(showIds);\nuseEffect(function(){var getTagsIdsList=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var tagsMap;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;tagsMap={};_context2.next=4;return Promise.all(showIds.map(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(showId){var tags,tagIds;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetchShowTagsId(showId);case 2:tags=_context.sent;tagIds=tags.map(function(tag){return tag.tag_id;});tagsMap[showId]=tagIds;case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}()));case 4:setTagIdsList(tagsMap);_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);setTagIdsError(_context2.t0);case 10:case\"end\":return _context2.stop();}}},_callee2,null,[[0,7]]);}));return function getTagsIdsList(){return _ref.apply(this,arguments);};}();if(showIds!==null){getTagsIdsList();}},[showIds]);useEffect(function(){var getTagsList=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){var tagNamesMap,showId,tagIds,tagNames;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;if(!(tagIdsList!==null)){_context4.next=14;break;}tagNamesMap={};_context4.t0=_regeneratorRuntime().keys(tagIdsList);case 4:if((_context4.t1=_context4.t0()).done){_context4.next=13;break;}showId=_context4.t1.value;tagIds=tagIdsList[showId];_context4.next=9;return Promise.all(tagIds.map(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(tagId){var tagName;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetchTagName(tagId);case 2:tagName=_context3.sent;return _context3.abrupt(\"return\",tagName);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2){return _ref4.apply(this,arguments);};}()));case 9:tagNames=_context4.sent;tagNamesMap[showId]=tagNames;_context4.next=4;break;case 13:setTagsList(tagNamesMap);case 14:_context4.next=19;break;case 16:_context4.prev=16;_context4.t2=_context4[\"catch\"](0);setTagsError(_context4.t2);case 19:case\"end\":return _context4.stop();}}},_callee4,null,[[0,16]]);}));return function getTagsList(){return _ref3.apply(this,arguments);};}();getTagsList();},[tagIdsList]);return tagsList;}export default FetchShowTags;","map":{"version":3,"names":["useState","useEffect","fetchShowTagsId","fetchTagName","FetchShowTags","galleriesInfo","tagIdsList","setTagIdsList","tagsList","setTagsList","tagIdsError","setTagIdsError","tagsError","setTagsError","showIds","setShowIds","map","galleryInfo","id","getTagsIdsList","tagsMap","Promise","all","showId","tags","tagIds","tag","tag_id","getTagsList","tagNamesMap","tagId","tagName","tagNames"],"sources":["/Users/andrew/Desktop/exhi/exhi/exhi-lover/client/src/component/map/FetchShowTags.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { fetchShowTagsId, fetchTagName } from \"../../lib/api/Api\";\n\nfunction FetchShowTags(galleriesInfo) {\n  const [tagIdsList, setTagIdsList] = useState(null);\n  const [tagsList, setTagsList] = useState(null);\n  const [tagIdsError, setTagIdsError] = useState(null);\n  const [tagsError, setTagsError] = useState(null);\n  const [showIds, setShowIds] = useState(null);\n\n  //   console.log(\"ga\", galleriesInfo);\n  useEffect(() => {\n    if (galleriesInfo !== null) {\n      setShowIds(\n        galleriesInfo.map((galleryInfo) => {\n          return galleryInfo.id;\n        })\n      );\n    }\n  }, [galleriesInfo]);\n  //   console.log(showIds);\n\n  useEffect(() => {\n    const getTagsIdsList = async () => {\n      try {\n        const tagsMap = {};\n        await Promise.all(\n          showIds.map(async (showId) => {\n            const tags = await fetchShowTagsId(showId);\n            const tagIds = tags.map((tag) => tag.tag_id);\n            tagsMap[showId] = tagIds;\n          })\n        );\n        setTagIdsList(tagsMap);\n      } catch (e) {\n        setTagIdsError(e);\n      }\n    };\n    if (showIds !== null) {\n      getTagsIdsList();\n    }\n  }, [showIds]);\n\n  useEffect(() => {\n    const getTagsList = async () => {\n      try {\n        if (tagIdsList !== null) {\n          const tagNamesMap = {};\n          for (const showId in tagIdsList) {\n            const tagIds = tagIdsList[showId];\n            const tagNames = await Promise.all(\n              tagIds.map(async (tagId) => {\n                const tagName = await fetchTagName(tagId);\n                return tagName;\n              })\n            );\n            tagNamesMap[showId] = tagNames;\n          }\n          setTagsList(tagNamesMap);\n        }\n      } catch (e) {\n        setTagsError(e);\n      }\n    };\n    getTagsList();\n  }, [tagIdsList]);\n  return tagsList;\n}\n\nexport default FetchShowTags;\n"],"mappings":"qaAAA,OAASA,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CACA,OAASC,eAAT,CAA0BC,YAA1B,KAA8C,mBAA9C,CAEA,QAASC,cAAT,CAAuBC,aAAvB,CAAsC,CACpC,cAAoCL,QAAQ,CAAC,IAAD,CAA5C,wCAAOM,UAAP,eAAmBC,aAAnB,eACA,eAAgCP,QAAQ,CAAC,IAAD,CAAxC,yCAAOQ,QAAP,eAAiBC,WAAjB,eACA,eAAsCT,QAAQ,CAAC,IAAD,CAA9C,yCAAOU,WAAP,eAAoBC,cAApB,eACA,eAAkCX,QAAQ,CAAC,IAAD,CAA1C,yCAAOY,SAAP,eAAkBC,YAAlB,eACA,eAA8Bb,QAAQ,CAAC,IAAD,CAAtC,0CAAOc,OAAP,gBAAgBC,UAAhB,gBAEA;AACAd,SAAS,CAAC,UAAM,CACd,GAAII,aAAa,GAAK,IAAtB,CAA4B,CAC1BU,UAAU,CACRV,aAAa,CAACW,GAAd,CAAkB,SAACC,WAAD,CAAiB,CACjC,MAAOA,YAAW,CAACC,EAAnB,CACD,CAFD,CADQ,CAAV,CAKD,CACF,CARQ,CAQN,CAACb,aAAD,CARM,CAAT,CASA;AAEAJ,SAAS,CAAC,UAAM,CACd,GAAMkB,eAAc,4FAAG,uKAEbC,OAFa,CAEH,EAFG,wBAGbC,QAAO,CAACC,GAAR,CACJR,OAAO,CAACE,GAAR,6FAAY,iBAAOO,MAAP,0JACSrB,gBAAe,CAACqB,MAAD,CADxB,QACJC,IADI,eAEJC,MAFI,CAEKD,IAAI,CAACR,GAAL,CAAS,SAACU,GAAD,QAASA,IAAG,CAACC,MAAb,EAAT,CAFL,CAGVP,OAAO,CAACG,MAAD,CAAP,CAAkBE,MAAlB,CAHU,sDAAZ,gEADI,CAHa,QAUnBlB,aAAa,CAACa,OAAD,CAAb,CAVmB,mFAYnBT,cAAc,cAAd,CAZmB,sEAAH,kBAAdQ,eAAc,0CAApB,CAeA,GAAIL,OAAO,GAAK,IAAhB,CAAsB,CACpBK,cAAc,GACf,CACF,CAnBQ,CAmBN,CAACL,OAAD,CAnBM,CAAT,CAqBAb,SAAS,CAAC,UAAM,CACd,GAAM2B,YAAW,6FAAG,uMAEZtB,UAAU,GAAK,IAFH,4BAGRuB,WAHQ,CAGM,EAHN,yCAIOvB,UAJP,yEAIHiB,MAJG,oBAKNE,MALM,CAKGnB,UAAU,CAACiB,MAAD,CALb,wBAMWF,QAAO,CAACC,GAAR,CACrBG,MAAM,CAACT,GAAP,6FAAW,kBAAOc,KAAP,2JACa3B,aAAY,CAAC2B,KAAD,CADzB,QACHC,OADG,iDAEFA,OAFE,0DAAX,iEADqB,CANX,QAMNC,QANM,gBAYZH,WAAW,CAACN,MAAD,CAAX,CAAsBS,QAAtB,CAZY,+BAcdvB,WAAW,CAACoB,WAAD,CAAX,CAdc,6FAiBhBhB,YAAY,cAAZ,CAjBgB,uEAAH,kBAAXe,YAAW,2CAAjB,CAoBAA,WAAW,GACZ,CAtBQ,CAsBN,CAACtB,UAAD,CAtBM,CAAT,CAuBA,MAAOE,SAAP,CACD,CAED,cAAeJ,cAAf"},"metadata":{},"sourceType":"module"}