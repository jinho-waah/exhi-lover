{"ast":null,"code":"var _jsxFileName = \"/Users/andrew/Desktop/exhi/exhi/client/src/component/detail/DetailTemplate.js\",\n    _s = $RefreshSig$();\n\nimport axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport DetailViewer from \"./DetailViewer\";\nimport SubHeader from \"../header/SubHeader\";\nimport Footer from \"../common/Footer\";\nimport { fetchShowByShowId, fetchTagName } from \"../../lib/api/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst TemplateBlock = styled.div`\n  padding-top: 0.2rem;\n  box-sizing: border-box;\n  background: #000000;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-flow: row wrap;\n`;\n_c = TemplateBlock;\n\nconst DetailTemplate = _ref => {\n  _s();\n\n  let {\n    color\n  } = _ref;\n  const {\n    showId\n  } = useParams();\n  const [show, setShow] = useState(null);\n  const [tags, setTags] = useState(null);\n  const [tagsId, setTagsId] = useState(null);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    const fetchShow = async () => {\n      try {\n        setError(null);\n        setShow(null);\n        const data = await fetchShowByShowId(showId);\n        setShow(data);\n      } catch (e) {\n        setError(e);\n      }\n    };\n\n    fetchShow();\n  }, [showId]);\n  useEffect(() => {\n    const fetchTagsId = async () => {\n      try {\n        setError(null);\n        const tagsIdData = await Promise.all(show.map(async show => {\n          const showTagIdurl = `/api/exhibition_tags/shows/${show.id}`;\n          const response = await axios.get( // `https://exhi-lover.com${showTagIdurl}`\n          `http://localhost:5100${showTagIdurl}`);\n          return response.data;\n        }));\n\n        if (tagsIdData.length > 0) {\n          const tagsIdArray = tagsIdData.reduce((acc, innerArray) => {\n            innerArray.forEach(row => {\n              const {\n                exhibition_id,\n                tag_id\n              } = row;\n              const index = acc.findIndex(obj => obj.exhibition_id === exhibition_id);\n\n              if (index === -1) {\n                acc.push({\n                  exhibition_id,\n                  tags: [tag_id]\n                });\n              } else {\n                acc[index].tags.push(tag_id);\n              }\n            });\n            return acc;\n          }, []);\n          setTagsId(tagsIdArray);\n        }\n      } catch (e) {\n        setError(e);\n      }\n    };\n\n    fetchTagsId();\n  }, [show]);\n  useEffect(() => {\n    const fetchTag = async () => {\n      try {\n        setError(null);\n        const tagData = await Promise.all(tagsId.map(async _ref2 => {\n          let {\n            exhibition_id,\n            tags\n          } = _ref2;\n          const tagNames = await Promise.all(tags.map(async tagId => {\n            const data = await fetchTagName(tagId);\n            return data;\n          }));\n          return {\n            exhibition_id,\n            tagNames\n          };\n        }));\n        setTags(tagData.reduce((acc, _ref3) => {\n          let {\n            exhibition_id,\n            tagNames\n          } = _ref3;\n          acc[exhibition_id] = tagNames;\n          return acc;\n        }, {}));\n      } catch (e) {\n        setError(e);\n      }\n    };\n\n    if (tagsId !== null) {\n      fetchTag();\n    }\n  }, [tagsId]);\n  if (error) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"ERR\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 111,\n    columnNumber: 21\n  }, this);\n  if (!show) return null;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(SubHeader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(TemplateBlock, {\n      children: /*#__PURE__*/_jsxDEV(DetailViewer, {\n        show: show,\n        color: color,\n        tags: tags\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(DetailTemplate, \"sPAguaymiQKEMRGT9e/Ov5PKi3E=\", false, function () {\n  return [useParams];\n});\n\n_c2 = DetailTemplate;\nexport default DetailTemplate;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"TemplateBlock\");\n$RefreshReg$(_c2, \"DetailTemplate\");","map":{"version":3,"names":["axios","useEffect","useState","useParams","styled","DetailViewer","SubHeader","Footer","fetchShowByShowId","fetchTagName","TemplateBlock","div","DetailTemplate","color","showId","show","setShow","tags","setTags","tagsId","setTagsId","error","setError","fetchShow","data","e","fetchTagsId","tagsIdData","Promise","all","map","showTagIdurl","id","response","get","length","tagsIdArray","reduce","acc","innerArray","forEach","row","exhibition_id","tag_id","index","findIndex","obj","push","fetchTag","tagData","tagNames","tagId"],"sources":["/Users/andrew/Desktop/exhi/exhi/client/src/component/detail/DetailTemplate.js"],"sourcesContent":["import axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport DetailViewer from \"./DetailViewer\";\nimport SubHeader from \"../header/SubHeader\";\nimport Footer from \"../common/Footer\";\nimport { fetchShowByShowId, fetchTagName } from \"../../lib/api/api\";\n\nconst TemplateBlock = styled.div`\n  padding-top: 0.2rem;\n  box-sizing: border-box;\n  background: #000000;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-flow: row wrap;\n`;\n\nconst DetailTemplate = ({ color }) => {\n  const { showId } = useParams();\n  const [show, setShow] = useState(null);\n  const [tags, setTags] = useState(null);\n  const [tagsId, setTagsId] = useState(null);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    const fetchShow = async () => {\n      try {\n        setError(null);\n        setShow(null);\n        const data = await fetchShowByShowId(showId);\n        setShow(data);\n      } catch (e) {\n        setError(e);\n      }\n    };\n    fetchShow();\n  }, [showId]);\n\n  useEffect(() => {\n    const fetchTagsId = async () => {\n      try {\n        setError(null);\n        const tagsIdData = await Promise.all(\n          show.map(async (show) => {\n            const showTagIdurl = `/api/exhibition_tags/shows/${show.id}`;\n            const response = await axios.get(\n              // `https://exhi-lover.com${showTagIdurl}`\n              `http://localhost:5100${showTagIdurl}`\n            );\n            return response.data;\n          })\n        );\n        if (tagsIdData.length > 0) {\n          const tagsIdArray = tagsIdData.reduce((acc, innerArray) => {\n            innerArray.forEach((row) => {\n              const { exhibition_id, tag_id } = row;\n              const index = acc.findIndex(\n                (obj) => obj.exhibition_id === exhibition_id\n              );\n              if (index === -1) {\n                acc.push({ exhibition_id, tags: [tag_id] });\n              } else {\n                acc[index].tags.push(tag_id);\n              }\n            });\n            return acc;\n          }, []);\n          setTagsId(tagsIdArray);\n        }\n      } catch (e) {\n        setError(e);\n      }\n    };\n\n    fetchTagsId();\n  }, [show]);\n\n  useEffect(() => {\n    const fetchTag = async () => {\n      try {\n        setError(null);\n        const tagData = await Promise.all(\n          tagsId.map(async ({ exhibition_id, tags }) => {\n            const tagNames = await Promise.all(\n              tags.map(async (tagId) => {\n                const data = await fetchTagName(tagId);\n                return data;\n              })\n            );\n            return { exhibition_id, tagNames };\n          })\n        );\n        setTags(\n          tagData.reduce((acc, { exhibition_id, tagNames }) => {\n            acc[exhibition_id] = tagNames;\n            return acc;\n          }, {})\n        );\n      } catch (e) {\n        setError(e);\n      }\n    };\n\n    if (tagsId !== null) {\n      fetchTag();\n    }\n  }, [tagsId]);\n\n  if (error) return <div>ERR</div>;\n  if (!show) return null;\n  return (\n    <>\n      <SubHeader />\n      <TemplateBlock>\n        <DetailViewer show={show} color={color} tags={tags} />\n      </TemplateBlock>\n      <Footer />\n    </>\n  );\n};\n\nexport default DetailTemplate;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}