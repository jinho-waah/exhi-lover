{"ast":null,"code":"import _regeneratorRuntime from\"/Users/andrew/Desktop/exhi/exhi/exhi-lover/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/andrew/Desktop/exhi/exhi/exhi-lover/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/andrew/Desktop/exhi/exhi/exhi-lover/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/Users/andrew/Desktop/exhi/exhi/exhi-lover/client/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3;import*as React from\"react\";import styled from\"styled-components\";import Post from\"./Post\";import colorSet from\"../../lib/styles/colorSet\";import{useEffect,useState,memo}from\"react\";import{Pagination}from\"@mui/material\";import{fetchShowTagsId,fetchTagName}from\"../../lib/api/Api\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var TemplateBlock=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  padding-top: 2px;\\n  box-sizing: border-box;\\n  align-items: center;\\n  flex-flow: row wrap;\\n  justify-content: center; /* Center content horizontally */\\n\"])));var PaginationBlock=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  padding-bottom: 3px;\\n\"])));var StyledPagination=styled(Pagination)(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  && {\\n    .MuiPaginationItem-root {\\n      color: white; // Change text color\\n      border-color: white; // Change border color\\n      &.Mui-selected {\\n        background-color: #333; // Change background color for selected page\\n      }\\n      &:hover {\\n        background-color: #555; // Change background color on hover\\n      }\\n    }\\n  }\\n\"])));var PostTemplate=function PostTemplate(_ref){var shows=_ref.shows;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),tags=_useState2[0],setTags=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),tagsId=_useState4[0],setTagsId=_useState4[1];var _useState5=useState(Math.ceil(shows.length/10)),_useState6=_slicedToArray(_useState5,2),pageCount=_useState6[0],setPageCount=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),paginationValue=_useState8[0],setPagenationValue=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],setError=_useState10[1];var handleChange=function handleChange(event,newPage){setPagenationValue(newPage);// Update the paginationValue state with the new page number\n};useEffect(function(){var fetchTagsId=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var tagsIdData,tagsIdArray;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setError(null);_context2.next=4;return Promise.all(shows.map(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(show){var data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetchShowTagsId(show.id);case 2:data=_context.sent;return _context.abrupt(\"return\",data);case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref3.apply(this,arguments);};}()));case 4:tagsIdData=_context2.sent;if(tagsIdData.length>0){tagsIdArray=tagsIdData.reduce(function(acc,innerArray){innerArray.forEach(function(row){var exhibition_id=row.exhibition_id,tag_id=row.tag_id;var index=acc.findIndex(function(obj){return obj.exhibition_id===exhibition_id;});if(index===-1){acc.push({exhibition_id:exhibition_id,tags:[tag_id]});}else{acc[index].tags.push(tag_id);}});return acc;},[]);setTagsId(tagsIdArray);}_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);setError(_context2.t0);case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return function fetchTagsId(){return _ref2.apply(this,arguments);};}();fetchTagsId();setPageCount(Math.ceil(shows.length/10));},[shows]);useEffect(function(){var fetchTag=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(){var tagData;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;setError(null);_context5.next=4;return Promise.all(tagsId.map(/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(_ref5){var exhibition_id,tags,tagNames;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:exhibition_id=_ref5.exhibition_id,tags=_ref5.tags;_context4.next=3;return Promise.all(tags.map(/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(tagId){var data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetchTagName(tagId);case 2:data=_context3.sent;return _context3.abrupt(\"return\",data);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref7.apply(this,arguments);};}()));case 3:tagNames=_context4.sent;return _context4.abrupt(\"return\",{exhibition_id:exhibition_id,tagNames:tagNames});case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x2){return _ref6.apply(this,arguments);};}()));case 4:tagData=_context5.sent;setTags(tagData.reduce(function(acc,_ref8){var exhibition_id=_ref8.exhibition_id,tagNames=_ref8.tagNames;acc[exhibition_id]=tagNames;return acc;},{}));_context5.next=11;break;case 8:_context5.prev=8;_context5.t0=_context5[\"catch\"](0);setError(_context5.t0);case 11:case\"end\":return _context5.stop();}}},_callee5,null,[[0,8]]);}));return function fetchTag(){return _ref4.apply(this,arguments);};}();if(tagsId!==null){fetchTag();}},[tagsId]);console.log();return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(TemplateBlock,{children:[shows.map(function(show,index){var key=\"\".concat(show.show_name);// create unique key prop value\nvar colorIndex=index%colorSet.length;// determine color index based on position in array\nvar color=colorSet[colorIndex];// get color from colorSet array\nreturn/*#__PURE__*/_jsx(Post,{show:show,color:color,tags:tags===null||tags===void 0?void 0:tags[show.id]},key);// pass color as prop to Post component\n}),/*#__PURE__*/_jsx(PaginationBlock,{children:/*#__PURE__*/_jsx(StyledPagination,{count:pageCount,page:paginationValue,onChange:handleChange})})]})});};export default/*#__PURE__*/memo(PostTemplate);","map":{"version":3,"names":["React","styled","Post","colorSet","useEffect","useState","memo","Pagination","fetchShowTagsId","fetchTagName","TemplateBlock","div","PaginationBlock","StyledPagination","PostTemplate","shows","tags","setTags","tagsId","setTagsId","Math","ceil","length","pageCount","setPageCount","paginationValue","setPagenationValue","error","setError","handleChange","event","newPage","fetchTagsId","Promise","all","map","show","id","data","tagsIdData","tagsIdArray","reduce","acc","innerArray","forEach","row","exhibition_id","tag_id","index","findIndex","obj","push","fetchTag","tagId","tagNames","tagData","console","log","key","show_name","colorIndex","color"],"sources":["/Users/andrew/Desktop/exhi/exhi/exhi-lover/client/src/component/post/PostTemplate.js"],"sourcesContent":["import * as React from \"react\";\nimport styled from \"styled-components\";\nimport Post from \"./Post\";\nimport colorSet from \"../../lib/styles/colorSet\";\nimport { useEffect, useState, memo } from \"react\";\nimport { Pagination } from \"@mui/material\";\nimport { fetchShowTagsId, fetchTagName } from \"../../lib/api/Api\";\n\nconst TemplateBlock = styled.div`\n  padding-top: 2px;\n  box-sizing: border-box;\n  align-items: center;\n  flex-flow: row wrap;\n  justify-content: center; /* Center content horizontally */\n`;\n\nconst PaginationBlock = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding-bottom: 3px;\n`;\n\nconst StyledPagination = styled(Pagination)`\n  && {\n    .MuiPaginationItem-root {\n      color: white; // Change text color\n      border-color: white; // Change border color\n      &.Mui-selected {\n        background-color: #333; // Change background color for selected page\n      }\n      &:hover {\n        background-color: #555; // Change background color on hover\n      }\n    }\n  }\n`;\n\nconst PostTemplate = ({ shows }) => {\n  const [tags, setTags] = useState(null);\n  const [tagsId, setTagsId] = useState(null);\n  const [pageCount, setPageCount] = useState(Math.ceil(shows.length / 10));\n  const [paginationValue, setPagenationValue] = useState(1);\n  const [error, setError] = useState(null);\n\n  const handleChange = (event, newPage) => {\n    setPagenationValue(newPage); // Update the paginationValue state with the new page number\n  };\n\n  useEffect(() => {\n    const fetchTagsId = async () => {\n      try {\n        setError(null);\n        const tagsIdData = await Promise.all(\n          shows.map(async (show) => {\n            const data = await fetchShowTagsId(show.id);\n            return data;\n          })\n        );\n        if (tagsIdData.length > 0) {\n          const tagsIdArray = tagsIdData.reduce((acc, innerArray) => {\n            innerArray.forEach((row) => {\n              const { exhibition_id, tag_id } = row;\n              const index = acc.findIndex(\n                (obj) => obj.exhibition_id === exhibition_id\n              );\n              if (index === -1) {\n                acc.push({ exhibition_id, tags: [tag_id] });\n              } else {\n                acc[index].tags.push(tag_id);\n              }\n            });\n            return acc;\n          }, []);\n          setTagsId(tagsIdArray);\n        }\n      } catch (e) {\n        setError(e);\n      }\n    };\n\n    fetchTagsId();\n    setPageCount(Math.ceil(shows.length / 10));\n  }, [shows]);\n\n  useEffect(() => {\n    const fetchTag = async () => {\n      try {\n        setError(null);\n        const tagData = await Promise.all(\n          tagsId.map(async ({ exhibition_id, tags }) => {\n            const tagNames = await Promise.all(\n              tags.map(async (tagId) => {\n                const data = await fetchTagName(tagId);\n                return data;\n              })\n            );\n            return { exhibition_id, tagNames };\n          })\n        );\n\n        setTags(\n          tagData.reduce((acc, { exhibition_id, tagNames }) => {\n            acc[exhibition_id] = tagNames;\n            return acc;\n          }, {})\n        );\n      } catch (e) {\n        setError(e);\n      }\n    };\n\n    if (tagsId !== null) {\n      fetchTag();\n    }\n  }, [tagsId]);\n  console.log();\n  return (\n    <>\n      <TemplateBlock>\n        {shows.map((show, index) => {\n          const key = `${show.show_name}`; // create unique key prop value\n          const colorIndex = index % colorSet.length; // determine color index based on position in array\n          const color = colorSet[colorIndex]; // get color from colorSet array\n          return (\n            <Post show={show} key={key} color={color} tags={tags?.[show.id]} />\n          ); // pass color as prop to Post component\n        })}\n        <PaginationBlock>\n          <StyledPagination\n            count={pageCount}\n            page={paginationValue}\n            onChange={handleChange}\n          />\n        </PaginationBlock>\n      </TemplateBlock>\n    </>\n  );\n};\n\nexport default memo(PostTemplate);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}